<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consommation des Pièces</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h2>Consommation par pièce</h2>
        <div id="roomData"></div>
        <h3 class="mt-4">Consommation totale en électricité : <span id="totalElectric"></span> kWh</h3>
    </div>

    <script>
        // Fetch consumption data from API
        fetch('/api/consumption')
            .then(response => response.json())
            .then(data => {
                const roomDataDiv = document.getElementById('roomData');
                const totalElectricSpan = document.getElementById('totalElectric');
                
                // Display total electricity consumption
                totalElectricSpan.textContent = parseFloat(data.total_electric).toFixed(2);

                // Loop through each room and display its data
                data.room_data.forEach(room => {
                    const roomInfo = `
                        <div class="mb-3">
                            <h4>Pièce : ${room.piece_nom}</h4>
                            <p>Température : ${room.latest_temperature ? `${room.latest_temperature} °C` : 'Données indisponibles'}</p>
                            <p>Humidité : ${room.latest_humidity ? `${room.latest_humidity} %` : 'Données indisponibles'}</p>
                            <p>Électricité : ${room.latest_electric ? `${room.latest_electric} kWh` : 'Données indisponibles'}</p>
                            <p>AQI : ${room.latest_AQI ? room.latest_AQI : 'Données indisponibles'}</p>
                        </div>
                    `;
                    roomDataDiv.innerHTML += roomInfo;
                });
            })
            .catch(error => console.error('Erreur lors de la récupération des données:', error));
    </script>
</body>
</html>
